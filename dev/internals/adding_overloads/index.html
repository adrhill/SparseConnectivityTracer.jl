<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Adding Overloads · SparseConnectivityTracer.jl</title><meta name="title" content="Adding Overloads · SparseConnectivityTracer.jl"/><meta property="og:title" content="Adding Overloads · SparseConnectivityTracer.jl"/><meta property="twitter:title" content="Adding Overloads · SparseConnectivityTracer.jl"/><meta name="description" content="Documentation for SparseConnectivityTracer.jl."/><meta property="og:description" content="Documentation for SparseConnectivityTracer.jl."/><meta property="twitter:description" content="Documentation for SparseConnectivityTracer.jl."/><meta property="og:url" content="https://adrhill.github.io/SparseConnectivityTracer.jl/internals/adding_overloads/"/><meta property="twitter:url" content="https://adrhill.github.io/SparseConnectivityTracer.jl/internals/adding_overloads/"/><link rel="canonical" href="https://adrhill.github.io/SparseConnectivityTracer.jl/internals/adding_overloads/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">SparseConnectivityTracer.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Getting Started</a></li><li><span class="tocitem">User Documentation</span><ul><li><a class="tocitem" href="../../user/global_vs_local/">Global vs. Local Sparsity</a></li><li><a class="tocitem" href="../../user/limitations/">Limitations</a></li><li><a class="tocitem" href="../../user/api/">API Reference</a></li></ul></li><li><span class="tocitem">Developer Documentation</span><ul><li><a class="tocitem" href="../how_it_works/">How SparseConnectivityTracer works</a></li><li class="is-active"><a class="tocitem" href>Adding Overloads</a><ul class="internal"><li><a class="tocitem" href="#Avoid-hand-written-overloads"><span>Avoid hand-written overloads</span></a></li><li><a class="tocitem" href="#Operator-classification"><span>Operator classification</span></a></li><li><a class="tocitem" href="#code-gen"><span>Overloading</span></a></li><li><a class="tocitem" href="#Example"><span>Example</span></a></li></ul></li><li><a class="tocitem" href="../api/">Internals Reference</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Developer Documentation</a></li><li class="is-active"><a href>Adding Overloads</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Adding Overloads</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/adrhill/SparseConnectivityTracer.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/adrhill/SparseConnectivityTracer.jl/blob/main/docs/src/internals/adding_overloads.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Adding-Overloads"><a class="docs-heading-anchor" href="#Adding-Overloads">Adding Overloads</a><a id="Adding-Overloads-1"></a><a class="docs-heading-anchor-permalink" href="#Adding-Overloads" title="Permalink"></a></h1><div class="admonition is-danger"><header class="admonition-header">Internals may change</header><div class="admonition-body"><p>The developer documentation might refer to internals which can change without warning in a future release of SparseConnectivityTracer. Only functionality that is exported or part of the <a href="../../user/api/#api">user documentation</a> adheres to semantic versioning.</p></div></div><p>Having read our guide <a href="../how_it_works/#how-sct-works"><em>&quot;How SparseConnectivityTracer works&quot;</em></a>, you might want to add your own methods on  <a href="../api/#SparseConnectivityTracer.GradientTracer"><code>GradientTracer</code></a>,  <a href="../api/#SparseConnectivityTracer.HessianTracer"><code>HessianTracer</code></a> and <a href="../api/#SparseConnectivityTracer.Dual"><code>Dual</code></a> to improve the performance of your functions or to work around some of SCT&#39;s <a href="../../user/limitations/#limitations">limitations</a>.</p><h2 id="Avoid-hand-written-overloads"><a class="docs-heading-anchor" href="#Avoid-hand-written-overloads">Avoid hand-written overloads</a><a id="Avoid-hand-written-overloads-1"></a><a class="docs-heading-anchor-permalink" href="#Avoid-hand-written-overloads" title="Permalink"></a></h2><div class="admonition is-warning"><header class="admonition-header">Don&#39;t overload manually</header><div class="admonition-body"><p>If you want to overload a <code>Function</code> that takes <code>Real</code> arguments,  we strongly discourage you from manually adding methods to your function that use our internal tracer types.</p><p>Instead, use the same code generation mechanisms that we use. This page of the documentation shows you how.</p></div></div><div class="admonition is-success"><header class="admonition-header">Copy one of our package extensions</header><div class="admonition-body"><p>The easiest way to add overloads is to copy one of our package extensions, <a href="https://github.com/adrhill/SparseConnectivityTracer.jl/blob/main/ext/SparseConnectivityTracerNNlibExt.jl">e.g. our NNlib extension</a>, and to modify it. Please upstream your additions by opening a pull request! We will help you out to get your feature merged.</p></div></div><h2 id="Operator-classification"><a class="docs-heading-anchor" href="#Operator-classification">Operator classification</a><a id="Operator-classification-1"></a><a class="docs-heading-anchor-permalink" href="#Operator-classification" title="Permalink"></a></h2><p>SCT currently supports three types of functions:</p><ol><li><strong>1-to-1</strong>: operators with one input and one output</li><li><strong>2-to-1</strong>: operators with two inputs and one output</li><li><strong>1-to-2</strong>: operators with one input and two outputs</li></ol><p>Depending on the type of function you&#39;re dealing with, you will have to specify the way in which your function is differentiable:</p><table><tr><th style="text-align: center">In</th><th style="text-align: center">Out</th><th style="text-align: left">Examples</th><th style="text-align: left">Methods you need to implement</th></tr><tr><td style="text-align: center">1</td><td style="text-align: center">1</td><td style="text-align: left"><code>sin</code>, <code>cos</code>, <code>abs</code></td><td style="text-align: left"><code>is_der1_zero_global</code>, <code>is_der2_zero_global</code></td></tr><tr><td style="text-align: center">2</td><td style="text-align: center">1</td><td style="text-align: left"><code>+</code>, <code>*</code>, <code>&gt;</code>, <code>isequal</code></td><td style="text-align: left"><code>is_der1_arg1_zero_global</code>, <code>is_der2_arg1_zero_global</code>, <code>is_der1_arg2_zero_global</code>, <code>is_der2_arg2_zero_global</code>, <code>is_der_cross_zero_global</code></td></tr><tr><td style="text-align: center">1</td><td style="text-align: center">2</td><td style="text-align: left"><code>sincos</code></td><td style="text-align: left"><code>is_der1_out1_zero_global</code>, <code>is_der2_out1_zero_global</code>, <code>is_der1_out2_zero_global</code>, <code>is_der2_out2_zero_global</code></td></tr></table><details class="admonition is-details"><summary class="admonition-header">Methods you have to implement for 1-to-1 operators</summary><div class="admonition-body"><table><tr><th style="text-align: left">Function</th><th style="text-align: left">Meaning</th></tr><tr><td style="text-align: left"><code>is_der1_zero_global(::typeof(f)) = false</code></td><td style="text-align: left"><span>$\frac{\partial f}{\partial x} \neq 0$</span> for some <span>$x$</span></td></tr><tr><td style="text-align: left"><code>is_der2_zero_global(::typeof(f)) = false</code></td><td style="text-align: left"><span>$\frac{\partial^2 f}{\partial x^2} \neq 0$</span> for some <span>$x$</span></td></tr></table><p>Optionally, to increase the sparsity of <a href="../../user/api/#SparseConnectivityTracer.TracerLocalSparsityDetector"><code>TracerLocalSparsityDetector</code></a>, you can additionally implement</p><table><tr><th style="text-align: left">Function</th><th style="text-align: left">Meaning</th></tr><tr><td style="text-align: left"><code>is_der1_zero_local(::typeof(f), x) = false</code></td><td style="text-align: left"><span>$\frac{\partial f}{\partial x} \neq 0$</span> for given <span>$x$</span></td></tr><tr><td style="text-align: left"><code>is_der2_zero_local(::typeof(f), x) = false</code></td><td style="text-align: left"><span>$\frac{\partial^2 f}{\partial x^2} \neq 0$</span> for given <span>$x$</span></td></tr></table><p>These fall back to </p><pre><code class="language-julia hljs">is_der1_zero_local(f::F, x) where {F} = is_der1_zero_global(f)
is_der2_zero_local(f::F, x) where {F} = is_der2_zero_global(f)</code></pre></div></details><details class="admonition is-details"><summary class="admonition-header">Methods you have to implement for 2-to-1 operators</summary><div class="admonition-body"><table><tr><th style="text-align: left">Function</th><th style="text-align: left">Meaning</th></tr><tr><td style="text-align: left"><code>is_der1_arg1_zero_global(::typeof(f)) = false</code></td><td style="text-align: left"><span>$\frac{\partial f}{\partial x} \neq 0$</span> for some <span>$x,y$</span></td></tr><tr><td style="text-align: left"><code>is_der2_arg1_zero_global(::typeof(f)) = false</code></td><td style="text-align: left"><span>$\frac{\partial^2 f}{\partial x^2} \neq 0$</span> for some <span>$x,y$</span></td></tr><tr><td style="text-align: left"><code>is_der1_arg2_zero_global(::typeof(f)) = false</code></td><td style="text-align: left"><span>$\frac{\partial f}{\partial y} \neq 0$</span> for some <span>$x,y$</span></td></tr><tr><td style="text-align: left"><code>is_der2_arg2_zero_global(::typeof(f)) = false</code></td><td style="text-align: left"><span>$\frac{\partial^2 f}{\partial y^2} \neq 0$</span> for some <span>$x,y$</span></td></tr><tr><td style="text-align: left"><code>is_der_cross_zero_global(::typeof(f)) = false</code></td><td style="text-align: left"><span>$\frac{\partial^2 f}{\partial x \partial y} \neq 0$</span> for some <span>$x,y$</span></td></tr></table><p>Optionally, to increase the sparsity of <a href="../../user/api/#SparseConnectivityTracer.TracerLocalSparsityDetector"><code>TracerLocalSparsityDetector</code></a>, you can additionally implement</p><table><tr><th style="text-align: left">Function</th><th style="text-align: left">Meaning</th></tr><tr><td style="text-align: left"><code>is_der1_arg1_zero_local(::typeof(f), x, y) = false</code></td><td style="text-align: left"><span>$\frac{\partial f}{\partial x} \neq 0$</span> for given <span>$x,y$</span></td></tr><tr><td style="text-align: left"><code>is_der2_arg1_zero_local(::typeof(f), x, y) = false</code></td><td style="text-align: left"><span>$\frac{\partial^2 f}{\partial x^2} \neq 0$</span> for given <span>$x,y$</span></td></tr><tr><td style="text-align: left"><code>is_der1_arg2_zero_local(::typeof(f), x, y) = false</code></td><td style="text-align: left"><span>$\frac{\partial f}{\partial x} \neq 0$</span> for given <span>$x,y$</span></td></tr><tr><td style="text-align: left"><code>is_der2_arg2_zero_local(::typeof(f), x, y) = false</code></td><td style="text-align: left"><span>$\frac{\partial^2 f}{\partial x^2} \neq 0$</span> for given <span>$x,y$</span></td></tr><tr><td style="text-align: left"><code>is_der_cross_zero_local(::typeof(f), x, y) = false</code></td><td style="text-align: left"><span>$\frac{\partial^2 f}{\partial x \partial y} \neq 0$</span> for given <span>$x,y$</span></td></tr></table><p>These fall back to </p><pre><code class="language-julia hljs">is_der1_arg1_zero_local(f::F, x, y) where {F} = is_der1_arg1_zero_global(f)
is_der2_arg1_zero_local(f::F, x, y) where {F} = is_der2_arg1_zero_global(f)
is_der1_arg2_zero_local(f::F, x, y) where {F} = is_der1_arg2_zero_global(f)
is_der2_arg2_zero_local(f::F, x, y) where {F} = is_der2_arg2_zero_global(f)
is_der_cross_zero_local(f::F, x, y) where {F} = is_der_cross_zero_global(f)</code></pre></div></details><details class="admonition is-details"><summary class="admonition-header">Methods you have to implement for 1-to-2 operators</summary><div class="admonition-body"><table><tr><th style="text-align: left">Function</th><th style="text-align: left">Meaning</th></tr><tr><td style="text-align: left"><code>is_der1_out1_zero_local(::typeof(f)) = false</code></td><td style="text-align: left"><span>$\frac{\partial f_1}{\partial x} \neq 0$</span> for some <span>$x$</span></td></tr><tr><td style="text-align: left"><code>is_der2_out1_zero_local(::typeof(f)) = false</code></td><td style="text-align: left"><span>$\frac{\partial^2 f_1}{\partial x^2} \neq 0$</span> for some <span>$x$</span></td></tr><tr><td style="text-align: left"><code>is_der1_out2_zero_local(::typeof(f)) = false</code></td><td style="text-align: left"><span>$\frac{\partial f_2}{\partial x} \neq 0$</span> for some <span>$x$</span></td></tr><tr><td style="text-align: left"><code>is_der2_out2_zero_local(::typeof(f)) = false</code></td><td style="text-align: left"><span>$\frac{\partial^2 f_2}{\partial x^2} \neq 0$</span> for some <span>$x$</span></td></tr></table><p>Optionally, to increase the sparsity of <a href="../../user/api/#SparseConnectivityTracer.TracerLocalSparsityDetector"><code>TracerLocalSparsityDetector</code></a>, you can additionally implement</p><table><tr><th style="text-align: left">Function</th><th style="text-align: left">Meaning</th></tr><tr><td style="text-align: left"><code>is_der1_out1_zero_local(::typeof(f), x) = false</code></td><td style="text-align: left"><span>$\frac{\partial f_1}{\partial x} \neq 0$</span> for given <span>$x$</span></td></tr><tr><td style="text-align: left"><code>is_der2_out1_zero_local(::typeof(f), x) = false</code></td><td style="text-align: left"><span>$\frac{\partial^2 f_1}{\partial x^2} \neq 0$</span> for given <span>$x$</span></td></tr><tr><td style="text-align: left"><code>is_der1_out2_zero_local(::typeof(f), x) = false</code></td><td style="text-align: left"><span>$\frac{\partial f_2}{\partial x} \neq 0$</span> for given <span>$x$</span></td></tr><tr><td style="text-align: left"><code>is_der2_out2_zero_local(::typeof(f), x) = false</code></td><td style="text-align: left"><span>$\frac{\partial^2 f_2}{\partial x^2} \neq 0$</span> for given <span>$x$</span></td></tr></table><p>These fall back to </p><pre><code class="language-julia hljs">is_der1_out1_zero_local(f::F, x) where {F} = is_der1_out1_zero_global(f)
is_der2_out1_zero_local(f::F, x) where {F} = is_der2_out1_zero_global(f)
is_der1_out2_zero_local(f::F, x) where {F} = is_der1_out2_zero_global(f)
is_der2_out2_zero_local(f::F, x) where {F} = is_der2_out2_zero_global(f)</code></pre></div></details><h2 id="code-gen"><a class="docs-heading-anchor" href="#code-gen">Overloading</a><a id="code-gen-1"></a><a class="docs-heading-anchor-permalink" href="#code-gen" title="Permalink"></a></h2><p>After implementing the required classification methods for a function, the function has not been overloaded on our tracer types yet. SCT provides three functions that generate code via meta-programming:</p><ul><li>1-to-1: <code>eval(SCT.generate_code_1_to_1(module_symbol, f))</code></li><li>2-to-1: <code>eval(SCT.generate_code_1_to_2(module_symbol, f))</code></li><li>1-to-2: <code>eval(SCT.generate_code_2_to_1(module_symbol, f))</code></li></ul><p>You are required to call the function that matches your type of operator.</p><div class="admonition is-success"><header class="admonition-header">Code generation</header><div class="admonition-body"><p>We will take a look at the code generation mechanism in the example below.</p></div></div><h2 id="Example"><a class="docs-heading-anchor" href="#Example">Example</a><a id="Example-1"></a><a class="docs-heading-anchor-permalink" href="#Example" title="Permalink"></a></h2><p>For some examples on how to overload methods, take a look at our <a href="https://github.com/adrhill/SparseConnectivityTracer.jl/tree/main/ext">package extensions</a>. Let&#39;s look at the <code>relu</code> activation function from <code>ext/SparseConnectivityTracerNNlibExt.jl</code>, which is a 1-to-1 operator defined as <span>$\text{relu}(x) = \text{max}(0, x)$</span>.</p><h3 id="Step-1:-Classification"><a class="docs-heading-anchor" href="#Step-1:-Classification">Step 1: Classification</a><a id="Step-1:-Classification-1"></a><a class="docs-heading-anchor-permalink" href="#Step-1:-Classification" title="Permalink"></a></h3><p>The <code>relu</code> function has a non-zero first-order derivative <span>$\frac{\partial f}{\partial x}=1$</span> for inputs <span>$x&gt;0$</span>.  The second derivative is zero everywhere. We therefore implement:</p><pre><code class="language-julia hljs">import SparseConnectivityTracer as SCT
using NNlib

SCT.is_der1_zero_global(::typeof(relu)) = false
SCT.is_der2_zero_global(::typeof(relu)) = true

SCT.is_der1_zero_local(::typeof(relu), x) = x &lt; 0</code></pre><div class="admonition is-warning"><header class="admonition-header">import SparseConnectivityTracer</header><div class="admonition-body"><p>Note that we imported SCT to extend its operator classification methods on <code>typeof(relu)</code>.</p></div></div><h3 id="Step-2:-Overloading"><a class="docs-heading-anchor" href="#Step-2:-Overloading">Step 2: Overloading</a><a id="Step-2:-Overloading-1"></a><a class="docs-heading-anchor-permalink" href="#Step-2:-Overloading" title="Permalink"></a></h3><p>The <code>relu</code> function has not been overloaded on our tracer types yet. Let&#39;s call the code generation utilities from the <a href="#code-gen"><em>&quot;Overloading&quot;</em></a> section for this purpose:</p><pre><code class="language-julia hljs">eval(SCT.generate_code_1_to_1(:NNlib, relu))</code></pre><p>The <code>relu</code> function is now ready to be called with SCT&#39;s tracer types.</p><details class="admonition is-details"><summary class="admonition-header">What is the eval call doing?</summary><div class="admonition-body"><p>Let&#39;s call <code>generate_code_1_to_1</code> without wrapping it <code>eval</code>:</p><pre><code class="language-julia hljs">SCT.generate_code_1_to_1(:NNlib, relu)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">quote
    begin
        begin
            <span class="sgr90">#= /home/runner/work/SparseConnectivityTracer.jl/SparseConnectivityTracer.jl/src/overloads/gradient_tracer.jl:38 =#</span>
            function NNlib.relu(t::(SparseConnectivityTracer).GradientTracer)
                <span class="sgr90">#= /home/runner/work/SparseConnectivityTracer.jl/SparseConnectivityTracer.jl/src/overloads/gradient_tracer.jl:38 =#</span>
                <span class="sgr90">#= /home/runner/work/SparseConnectivityTracer.jl/SparseConnectivityTracer.jl/src/overloads/gradient_tracer.jl:39 =#</span>
                return (SparseConnectivityTracer).gradient_tracer_1_to_1(t, false)
            end
        end
        begin
            <span class="sgr90">#= /home/runner/work/SparseConnectivityTracer.jl/SparseConnectivityTracer.jl/src/overloads/gradient_tracer.jl:52 =#</span>
            function NNlib.relu(d::D) where {P, T &lt;: (SparseConnectivityTracer).GradientTracer, D &lt;: (SparseConnectivityTracer).Dual{P, T}}
                <span class="sgr90">#= /home/runner/work/SparseConnectivityTracer.jl/SparseConnectivityTracer.jl/src/overloads/gradient_tracer.jl:52 =#</span>
                <span class="sgr90">#= /home/runner/work/SparseConnectivityTracer.jl/SparseConnectivityTracer.jl/src/overloads/gradient_tracer.jl:53 =#</span>
                x = (SparseConnectivityTracer).primal(d)
                <span class="sgr90">#= /home/runner/work/SparseConnectivityTracer.jl/SparseConnectivityTracer.jl/src/overloads/gradient_tracer.jl:54 =#</span>
                p_out = NNlib.relu(x)
                <span class="sgr90">#= /home/runner/work/SparseConnectivityTracer.jl/SparseConnectivityTracer.jl/src/overloads/gradient_tracer.jl:56 =#</span>
                t = (SparseConnectivityTracer).tracer(d)
                <span class="sgr90">#= /home/runner/work/SparseConnectivityTracer.jl/SparseConnectivityTracer.jl/src/overloads/gradient_tracer.jl:57 =#</span>
                is_der1_zero = (SparseConnectivityTracer).is_der1_zero_local(NNlib.relu, x)
                <span class="sgr90">#= /home/runner/work/SparseConnectivityTracer.jl/SparseConnectivityTracer.jl/src/overloads/gradient_tracer.jl:58 =#</span>
                t_out = (SparseConnectivityTracer).gradient_tracer_1_to_1(t, is_der1_zero)
                <span class="sgr90">#= /home/runner/work/SparseConnectivityTracer.jl/SparseConnectivityTracer.jl/src/overloads/gradient_tracer.jl:59 =#</span>
                return (SparseConnectivityTracer).Dual(p_out, t_out)
            end
        end
    end
    begin
        begin
            <span class="sgr90">#= /home/runner/work/SparseConnectivityTracer.jl/SparseConnectivityTracer.jl/src/overloads/hessian_tracer.jl:67 =#</span>
            function NNlib.relu(t::(SparseConnectivityTracer).HessianTracer)
                <span class="sgr90">#= /home/runner/work/SparseConnectivityTracer.jl/SparseConnectivityTracer.jl/src/overloads/hessian_tracer.jl:67 =#</span>
                <span class="sgr90">#= /home/runner/work/SparseConnectivityTracer.jl/SparseConnectivityTracer.jl/src/overloads/hessian_tracer.jl:68 =#</span>
                return (SparseConnectivityTracer).hessian_tracer_1_to_1(t, false, true)
            end
        end
        begin
            <span class="sgr90">#= /home/runner/work/SparseConnectivityTracer.jl/SparseConnectivityTracer.jl/src/overloads/hessian_tracer.jl:81 =#</span>
            function NNlib.relu(d::D) where {P, T &lt;: (SparseConnectivityTracer).HessianTracer, D &lt;: (SparseConnectivityTracer).Dual{P, T}}
                <span class="sgr90">#= /home/runner/work/SparseConnectivityTracer.jl/SparseConnectivityTracer.jl/src/overloads/hessian_tracer.jl:81 =#</span>
                <span class="sgr90">#= /home/runner/work/SparseConnectivityTracer.jl/SparseConnectivityTracer.jl/src/overloads/hessian_tracer.jl:82 =#</span>
                x = (SparseConnectivityTracer).primal(d)
                <span class="sgr90">#= /home/runner/work/SparseConnectivityTracer.jl/SparseConnectivityTracer.jl/src/overloads/hessian_tracer.jl:83 =#</span>
                p_out = NNlib.relu(x)
                <span class="sgr90">#= /home/runner/work/SparseConnectivityTracer.jl/SparseConnectivityTracer.jl/src/overloads/hessian_tracer.jl:85 =#</span>
                t = (SparseConnectivityTracer).tracer(d)
                <span class="sgr90">#= /home/runner/work/SparseConnectivityTracer.jl/SparseConnectivityTracer.jl/src/overloads/hessian_tracer.jl:86 =#</span>
                is_der1_zero = (SparseConnectivityTracer).is_der1_zero_local(NNlib.relu, x)
                <span class="sgr90">#= /home/runner/work/SparseConnectivityTracer.jl/SparseConnectivityTracer.jl/src/overloads/hessian_tracer.jl:87 =#</span>
                is_der2_zero = (SparseConnectivityTracer).is_der2_zero_local(NNlib.relu, x)
                <span class="sgr90">#= /home/runner/work/SparseConnectivityTracer.jl/SparseConnectivityTracer.jl/src/overloads/hessian_tracer.jl:88 =#</span>
                t_out = (SparseConnectivityTracer).hessian_tracer_1_to_1(t, is_der1_zero, is_der2_zero)
                <span class="sgr90">#= /home/runner/work/SparseConnectivityTracer.jl/SparseConnectivityTracer.jl/src/overloads/hessian_tracer.jl:89 =#</span>
                return (SparseConnectivityTracer).Dual(p_out, t_out)
            end
        end
    end
end</code></pre><p>As you can see, this returns a <code>quote</code>, a type of expression containing our generated Julia code.</p><p><strong>We have to use quotes:</strong>  The code generation mechanism lives in SCT, but the generated code has to be evaluated in the package extension, not SCT. As you can see in the generated quote, we handle the necessary name-spacing for you.</p></div></details><script type="module">import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
mermaid.initialize({
    startOnLoad: true,
    theme: "neutral"
});
</script></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../how_it_works/">« How SparseConnectivityTracer works</a><a class="docs-footer-nextpage" href="../api/">Internals Reference »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Thursday 5 September 2024 16:24">Thursday 5 September 2024</span>. Using Julia version 1.10.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
